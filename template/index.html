<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Search</title>
  <style>
    :root{
      --bg:#0f0f10;--bg-soft:#141416;--card:#17181a;--muted:#9ca3af;--text:#e5e7eb;--brand:#8b5cf6;--accent:#29c8e0;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:15px/1.5 Inter,ui-sans-serif,system-ui}

    .app{display:grid;grid-template-columns:72px 1fr 360px;height:100vh}
    @media(max-width:1100px){.app{grid-template-columns:72px 1fr}}

    .rail{background:var(--bg-soft);display:flex;flex-direction:column;align-items:center;padding:16px 8px;gap:14px;border-right:1px solid #1f1f22}
    .logo{width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,var(--brand),#06b6d4);display:grid;place-items:center;font-weight:800}
    .iconbtn{width:44px;height:44px;border-radius:12px;display:grid;place-items:center;color:var(--muted);cursor:pointer}
    .iconbtn:hover{background:#1b1c20;color:#fff}
    .rail .bottom{margin-top:auto}

    .center{padding:24px 28px;overflow:auto}
    .title{font-size:28px;font-weight:800;margin-bottom:18px}
    .searchbar{display:flex;gap:10px;background:var(--card);border:1px solid #22252b;border-radius:14px;align-items:center;padding:10px 12px;position:sticky;top:0;z-index:5}
    .searchbar input{flex:1;background:transparent;border:none;color:var(--text);outline:none;font-size:16px;padding:10px}
    .btn{background:linear-gradient(135deg,var(--brand),var(--accent));border:none;color:#000;font-weight:700;padding:10px 14px;border-radius:10px;cursor:pointer}

    h3.section{font-size:16px;color:#cbd5e1;margin:22px 0 10px;font-weight:700}

    .sources{display:flex;gap:12px;flex-wrap:wrap}
    .source{display:flex;align-items:center;gap:10px;background:var(--card);border:1px solid hsl(186, 72%, 86%);border-radius:12px;padding:10px 12px;text-decoration:none;color:#ffffff;min-width:220px; transition: color 0.3s;}
    .source:hover{color:#facc15;} /* hover yellow */
    .src-title{font-size:14px;font-weight:600}
    .src-meta{color:var(--muted);font-size:12px}

    .answer-card{background:var(--card);border:1px solid #afc0e4;border-radius:14px;padding:18px}
    .answer-toolbar{display:flex;gap:10px;justify-content:flex-end;margin-bottom:8px}
    .chip{padding:6px 10px;border-radius:999px;background:#1d1f24;color:var(--muted);font-size:12px;border:1px solid #242830;cursor:pointer}
    .answer{white-space:pre-wrap}

    .right{display:flex;flex-direction:column;border-left:1px solid #1f1f22;background:var(--bg-soft);padding:18px;gap:14px}
    .card{background:var(--card);border:1px solid #b2c8f3;border-radius:12px;padding:10px;text-decoration:none;color:#ffffff; transition: color 0.3s;}
    .card:hover{color:#facc15;} /* hover yellow */
    .thumb{height:80px;border-radius:10px;background:linear-gradient(135deg,#111,#222);display:flex;align-items:center;justify-content:center;position:relative}
    .play{width:28px;height:28px;border-radius:999px;background:#0008;border:1px solid #fff6;display:grid;place-items:center}
    .grid{display:grid;gap:10px}
    .stamp{color:var(--muted);font-size:12px}
  </style>

 
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
<div class="app">

  <aside class="rail">
    <div class="logo">AI</div>
    <div class="iconbtn">üè†</div>
    <div class="iconbtn">üïò</div>
    <div class="iconbtn">üìö</div>
    <div class="iconbtn">‚öôÔ∏è</div>
    <div class="bottom iconbtn">‚ûï</div>
  </aside>

  <main class="center">
    <div class="title">AI Search</div>
    <div class="searchbar">
      <input id="q" placeholder="Ask anything‚Ä¶"/>
      <button id="searchBtn" class="btn">Search</button>
    </div>

    <h3 class="section">Sources</h3>
    <div id="sources" class="sources"></div>

    <h3 class="section">Answer</h3>
    <div class="answer-card">
      <div class="answer-toolbar">
        <button id="copyBtn" class="chip">Copy</button>
      </div>
      <div id="answer" class="answer">Type a query to get an answer.</div>
    </div>
  </main>

  <aside class="right">
    <div class="card">
      <h4>Videos</h4>
      <div class="grid" id="videos"></div>
    </div>
    <div class="card">
      <h4>Research Papers</h4>
      <div class="grid" id="papers"></div>
    </div>
  </aside>
</div>

<script>
  const API_URL = (location.hostname === 'localhost' || location.hostname === '127.0.0.1')
    ? 'http://127.0.0.1:5000/search' : '/search';

  const qEl = document.getElementById('q');
  const answerEl = document.getElementById('answer');
  const sourcesEl = document.getElementById('sources');
  const videosEl = document.getElementById('videos');
  const papersEl = document.getElementById('papers');

  async function doSearch(){
    const query = qEl.value.trim();
    if(!query) return;
    answerEl.textContent = "Loading...";
    sourcesEl.innerHTML = videosEl.innerHTML = papersEl.innerHTML = "";

    try{
      const res = await fetch(API_URL,{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({query})
      });
      const data = await res.json();

      // ‚úÖ Render answer as Markdown
      answerEl.innerHTML = marked.parse(data.answer || "No answer found.");

      // Sources
      (data.sources||[]).forEach(s=>{
        const a = document.createElement('a');
        a.className='source';
        a.href = s.link;
        a.target = '_blank';
        a.innerHTML = `<div>
          <div class="src-title">${s.title||'Untitled'}</div>
          <div class="src-meta">${new URL(s.link).hostname}</div>
        </div>`;
        sourcesEl.appendChild(a);
      });

      // YouTube Videos
      (data.videos||[]).slice(0,4).forEach(v=>{
        const div = document.createElement('a');
        div.href = v.url;
        div.target='_blank'; 
        div.className='card video-card';
        div.innerHTML = `
          <div class="thumb">
            <img src="${v.thumbnail}" alt="${v.title}" style="width:100%;height:100%;object-fit:cover;border-radius:10px;">
            <div class="play">‚ñ∂</div>
          </div>
          <div style="margin-top:8px;font-weight:600">${v.title}</div>
          <div class="stamp">${v.channel || 'YouTube'}</div>`;
        videosEl.appendChild(div);
      });

      // Research Papers
      (data.papers||[]).slice(0,4).forEach(p=>{
        const div = document.createElement('a');
        div.href = p.link;
        div.target='_blank';
        div.className='card';
        div.innerHTML=`<div style="font-weight:600">${p.title}</div>
          <div class="stamp">arXiv</div>`;
        papersEl.appendChild(div);
      });

    }catch(e){
      answerEl.textContent = "Error fetching results.";
      console.error(e);
    }
  }

  document.getElementById('searchBtn').addEventListener('click',doSearch);
  qEl.addEventListener('keydown',e=>{if(e.key==='Enter')doSearch()});
  document.getElementById('copyBtn').addEventListener('click',()=>navigator.clipboard.writeText(answerEl.innerText));
</script>
</body>
</html>
